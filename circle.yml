machine:
  java:
    version: oraclejdk8
  services:
    - redis
  environment:
    LOG_APP_LEVEL: INFO
    MYSQL_USER: ubuntu
    MYSQL_PASSWORD: ""
    _JAVA_OPTIONS: "-Xms512m -Xmx1024m"

dependencies:
  override:
    - ls

database:
  override:
    - mysql -e "create database IF NOT EXISTS flowupdb;" -uroot

test:
  override:
    - sbt test:
        timeout: 1200

deployment:
  prod:
    branch: master
    commands:
      - sbt dist && aws s3 sync target/universal/ s3://flowupserver-builds